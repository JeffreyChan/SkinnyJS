!function(a){var b={};a.registerDropDownMenuSkin=function(a,c){b[a]=c},a.fn.swapClasses=function(a,b,c){var d=c?a:b,e=c?b:a;return this.hasClass(d)||this.addClass(d).removeClass(e),this};var c=function(a,b){a.swapClasses("hover","nohover",b)},d=function(a,b,c){if(1===a.nodeType&&b.call(a,a,c)!==!1)for(var e=0,f=a.childNodes.length;f>e;e++)d(a.childNodes[e],b,c)},e=function(b,c){var e=[];return b.each(function(){d(this,c,e)}),a(e)},f=function(b){var c=a.extend.apply({},arguments);for(var d in c)"function"==typeof b[d]&&"function"!=typeof c[d]&&(c[d]=a.noop);return c},g={showOnHover:!0,linksWithSubmenusEnabled:!1,selected:a.noop,beforeShowPanel:a.noop,beforeHidePanel:a.noop,showPanelComplete:a.noop,hidePanelComplete:a.noop,position:a.noop,skin:"basic"};a.fn.dropDownMenu=function(d){if(0===this.length)return this;var i=b[d.skin];if(!i)throw new Error("Invalid dropDownMenu skin: "+d.skin);var j=f({},g,i||{},d);j.showOnHover||(j.linksWithSubmenusEnabled=!1);var k=150,l=function(b){b.addClass("menu-item-top");var d=[],f={parent:null,children:[]},g=!1,i=!1,l=function(b,d){function h(a){if(A){var b=+new Date-A;A=!1,200>b&&(a.preventDefault(),a.stopPropagation())}}var l=this;this.$panel=b,this.$item=d||b.closest(".menu-item"),this.$parentPanel=this.$item.closest(".menu-panel"),this.isTopLevel=0===this.$parentPanel.length,this.parent=null,this.children=[],this.isOpen=!1,this.transitioning=!1,this.$panel&&this.$panel.data("PanelInstance",this);var n=function(){l.$item.addClass("menu-item-with-submenu").on({press:B,click:h}).hoverDelay(w,x,{delayOver:l.isTopLevel&&!j.showOnHover?0:200,delayOut:500}),l.isTopLevel&&l.$item.on("pointerout",function(b){if(!l.isOpen){if(b.relatedTarget&&a(this).has(b.relatedTarget).length>0&&!a(this).is(b.relatedTarget))return;u(!1)}}),l.$panel&&(l.$panel.click(function(b){var c=a(b.target).closest(".menu-item",l.$panel);if(c&&!c.hasClass("menu-item-with-submenu")){var d=t(b);if(d.$selectedItem=c,d.selectedItem=c[0],j.selected.call(this,d),d.cancel)return b.stopPropagation(),void 0;if(!b.isDefaultPrevented())return;m(b)}b.stopPropagation()}),j.linksWithSubmenusEnabled||q().on("click",p))},p=function(a){a.preventDefault()},q=function(){return e(l.$item,function(b,c){return a(b).hasClass("menu-panel")?!1:("A"==b.tagName&&c.push(b),!0)})};this.resolveParent=function(){l.parent=l.$parentPanel.data("PanelInstance")||f,l.parent.children.push(l)};var r=null;this.getLevel=function(){if(null===r){r=-1;for(var a=l.parent;a;)a=a.parent,r++}return r};var s;this.getSiblings=function(){return s||(s=[],l.parent&&a.each(l.parent.children,function(){this!==l&&s.push(this)})),s};var t=function(a){return{$panel:l.$panel,panel:l,$parentPanel:l.$parentPanel,parentPanel:l.$parentPanel[0],$item:l.$item,item:l.$item[0],level:l.getLevel(),innerEvent:a,preventDefault:function(){this.cancel=!0}}},u=function(a){c(l.$item,a)},v=function(){return l.isTopLevel?g||j.showOnHover:!0},w=function(a){l.isTopLevel&&u(!0),v()&&l.show(a)},x=function(a){(!l.isTopLevel||j.showOnHover)&&v()&&l.hide(a)};this.show=function(c){if(!l.transitioning&&!l.isOpen){var d;l.$panel&&(d=t(c),j.beforeShowPanel.call(l,d),d.cancel)||(a.each(l.getSiblings(),function(){this.hide(c)}),o(c),u(!0),l.$panel&&(l.transitioning=!0,d=t(c),j.position(d),j.animationShow?j.animationShow.call(l,d,y):l.isTopLevel?(b.show(),y()):b.fadeIn(k,y)))}};var y=function(a){l.isOpen=!0,l.transitioning=!1,j.showPanelComplete.call(l,t(a))};this.hide=function(c){if(l.isOpen&&!l.transitioning){if(l.$panel){var d=t(c);if(j.beforeHidePanel.call(l,d),d.cancel)return}u(!1),l.$panel&&(l.transitioning=!0,a.each(l.children,function(){this.hide(c)}),j.animationHide?j.animationHide.call(l,t(c),z):l.isTopLevel?(b.hide(),z()):b.fadeOut(k,z))}};var z=function(a){l.isOpen=!1,l.transitioning=!1,j.hidePanelComplete.call(l,t(a))},A=!1,B=function(b){if(b.stopPropagation(),l.$panel&&"mouse"!=b.pointerType){if(l.$panel.length>0){var c=a(b.target).closest(".menu-panel");if(c.length>0&&c[0]===l.$panel[0])return A=!1,void 0}A=+new Date,b.preventDefault(),l.transitioning||(l[l.isOpen?"hideClick":"showClick"](b),l.isTopLevel&&(i=+new Date))}};this.showClick=function(a){l.isTopLevel&&(g=!0),l.show(a)},this.hideClick=function(a){l.isTopLevel&&(g=!1),l.hide(a)},this.hideForce=function(a){g=!1,l.hide(a)},n.apply(this)},m=function(b){i=+new Date,a.each(f.children,function(){this.hideForce(b)})},n=function(a){if(i){var b=+new Date-i;if(i=!1,200>b)return}m(a)};h.push(m);var o=function(a){for(var b=0;b<h.length;b++)h[b]!==m&&h[b](a)};b.find(".menu-panel").each(function(){d.push(new l(a(this)))}),b.not(".menu-item-with-submenu").each(function(){d.push(new l(null,a(this)))}),a.each(d,function(){this.resolveParent()}),b.find(".menu-item").hover(function(){c(a(this),!0)},function(){c(a(this),!1)}).each(function(){c(a(this),!1)}),a(document).on("click",n)};return this.each(function(){var b=e(a(this),function(b,c){return a(b).hasClass("menu-item")?(c.push(b),!1):!0});l(b)}),this};var h=[]}(jQuery);