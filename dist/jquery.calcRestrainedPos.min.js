!function(a){var b={apply:!1,container:null,direction:"north",offsets:{},viewport:!0},c={north:"east",east:"south",south:"west",west:"north"};a.calcRestrainedPos=function(d){function e(a){var b;return n&&(b=n[a]),b||(b=o),b}function f(a){switch(a){case"north":u.top=p.top-o.height-t.vertical,u.left=Math.max(t.padding,p.left+p.width/2-o.width/2),d.cornerAdjacent&&!l(a,u)&&(u.left=p.left+t.padding);break;case"east":u.top=p.top+p.height/2-o.height/2,u.left=p.left+p.width+t.horizontal,d.cornerAdjacent&&!l(a,u)&&(u.top=p.top+t.padding);break;case"south":u.top=p.top+p.height+t.vertical,u.left=Math.max(t.padding,p.left+p.width/2-o.width/2),d.cornerAdjacent&&!l(a,u)&&(u.left=p.left+t.padding);break;case"west":u.top=p.top+p.height/2-o.height/2,u.left=p.left-o.width-t.horizontal,d.cornerAdjacent&&!l(a,u)&&(u.top=p.top+t.padding)}}function g(a,b){null!==q&&(u.top<q.top?(u.top=q.top+t.container,!d.cornerAdjacent||"east"!==a&&"west"!==a||l(a,u)||(u.top=p.top+t.padding,b.minY=u.top)):u.top+o.height>q.top+q.height&&(u.top=q.top+q.height-o.height-t.container,!d.cornerAdjacent||"east"!==a&&"west"!==a||l(a,u)||(u.top=p.top+p.height-t.padding-o.height,b.maxY=u.top)),u.left+o.width>q.left+q.width?(u.left=q.left+q.width-o.width-t.container,!d.cornerAdjacent||"north"!==a&&"south"!==a||l(a,u)||(u.left=p.left+p.width-t.padding-o.width,b.maxX=u.left)):u.left<q.left&&(u.left=q.left+t.container,!d.cornerAdjacent||"north"!==a&&"south"!==a||l(a,u)||(u.left=p.left+t.padding,b.minX=u.left)))}function h(a,b){d.viewport===!0&&(u.top<t.viewport?(u.top=t.viewport,!d.cornerAdjacent||"east"!==a&&"west"!==a||l(a,u)||(u.top=p.top+t.padding,b.minY=u.top)):u.top+o.height>s.height&&(u.top=s.height-o.height-t.viewport,!d.cornerAdjacent||"east"!==a&&"west"!==a||l(a,u)||(u.top=p.top+p.height-t.padding-o.height,b.maxY=u.top)),u.left+o.width>s.width?(u.left=s.width-o.width-t.viewport,!d.cornerAdjacent||"north"!==a&&"south"!==a||l(a,u)||(u.left=p.left+p.width-t.padding-o.width,b.maxX=u.left)):u.left<t.viewport&&(u.left=t.viewport,!d.cornerAdjacent||"north"!==a&&"south"!==a||l(a,u)||(u.left=p.left+t.padding,b.minX=u.left)))}function i(a,b,c,d,e){for(var f,g,h,i,j,k=[{min:a,max:b}];k.length&&(j=e());)for(g=j.pos-(d+c),h=j.pos+j.size+d,f=0;f<k.length;f++){if(i=k[f],g<=i.min)h>i.min&&(i.min=Math.max(i.min,h));else if(h>=i.max)i.max=Math.min(i.max,g);else{var l={min:h,max:i.max};i.max=g,l.min<l.max&&k.splice(f+1,0,l)}i.min>=i.max&&(k.splice(f,1),f--)}var m,n=p.left+(p.width-o.width)/2,q=a-1,r=Number.MAX_VALUE;for(f=0;f<k.length&&r>0;f++)i=k[f],n<i.min?(m=i.min-n,r>m&&(q=i.min,r=m)):n>i.max?(m=n-i.max,r>m&&(q=i.max,r=m)):(q=n,r=0);return(a>q||q>b)&&(q=null),q}function j(a,b){if(r){var c,e,f,g,h=0,j=r.slice();if("east"===a||"west"===a){var k=b.minX-t.horizontal,l=b.minX+o.width+t.horizontal;c=b.minY,e=b.maxY,g=o.height,d.cornerAdjacent&&o.height>p.height&&j.splice(0,0,{left:k,width:l-k,top:p.top+p.height-o.height,height:o.height-p.height}),f=i(c,e,g,t.vertical,function(){for(var a,b=null;!b&&h<j.length;h++)a=j[h],a.left<=l&&a.left+a.width>=k&&(b={pos:a.top,size:a.height});return b}),null!==f?(u.left=b.minX,u.top=f):(u.left=b.minX-1,u.top=b.minY-1)}else{var m=b.minY-t.vertical,n=b.minY+o.height+t.vertical;c=b.minX,e=b.maxX,g=o.width,d.cornerAdjacent&&o.width>p.width&&j.splice(0,0,{top:m,height:n-m,left:p.left+p.width-o.width,width:o.width-p.width}),f=i(c,e,g,t.horizontal,function(){for(var a,b=null;!b&&h<j.length;h++)a=j[h],a.top<=n&&a.top+a.height>=m&&(b={pos:a.left,size:a.width});return b}),null!==f?(u.left=f,u.top=b.minY):(u.left=b.minX-1,u.top=b.minY-1)}}}function k(a,b){switch(a){case"north":case"south":b.minX=Math.max(b.minX,p.left-o.width+t.padding),b.maxX=Math.min(p.left+p.width-t.padding,b.maxX-o.width),b.minY=b.maxY=u.top;break;case"east":case"west":b.minY=Math.max(b.minY,p.top-o.height+t.padding),b.maxY=Math.min(p.top+p.height-t.padding,b.maxY-o.height),b.minX=b.maxX=u.left}return b}function l(a,b){var c=!0;switch(a){case"north":case"south":c=b.left>=p.left+t.padding&&b.left<=p.left+p.width-t.padding||b.left+o.width<=p.left+p.width-t.padding&&b.left+o.width>=p.left+t.padding;break;case"east":case"west":c=b.top>=p.top+t.padding&&b.top<=p.top+p.bottom-t.padding||b.top+o.height<=p.top+p.height-t.padding&&b.top+o.height<=p.top+p.height-t.padding}return c}function m(a,b){return a.left>=b.minX&&a.left<=b.maxX&&a.top>=b.minY&&a.top<=b.maxY}d=a.extend({},b,d);var n=d.contentSizes,o=d.bounds||a(d.content).clientRect(),p=d.contextBounds||a(d.context).clientRect(),q=d.containerBounds||(d.container?a(d.container).clientRect():null),r=d.exclusions,s=d.viewportBounds||{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight},t=a.extend({padding:0,viewport:0,container:0,vertical:0,horizontal:0},d.offsets||{}),u=d.reset||{},v=d.direction;v in c||(v="north");var w,x,y,z,A=v;w=x=0,y=s.width,z=s.height,null!==q&&(w=q.left+t.container,x=q.top+t.container,y=q.left+q.width-t.container,z=q.top+q.height-t.container),d.viewport===!0&&(w=Math.max(t.viewport,w),x=Math.max(t.viewport,x),y=Math.min(s.width-t.viewport,y),z=Math.min(s.height-t.viewport,z));for(var B;;){o=e(v),f(v),B=k(v,{minX:w,minY:x,maxX:y,maxY:z}),g(v,B),h(v,B),m(u,B)&&j(v,B);var C=a.extend({},o,u);if(m(u,B)&&(!d.cornerAdjacent||l(v,u))&&!a.doBoundingBoxesIntersect(C,p))break;if(c[v]===A){if(d.giveMeSomething)break;return null}v=c[v]}return u.maxWidth=s.width-u.left-t.viewport,o.width>=s.width&&(u.width="auto",u.left="0px",u.margin="0 "+t.padding+"px",u.maxWidth="100%"),{direction:v,pos:u}},a.doBoundingBoxesIntersect=function(a,b){return a.left<b.left+b.width&&a.left+a.width>b.left&&a.top<b.top+b.height&&a.top+a.height>b.top}}(jQuery);